(()=>{"use strict";var t,e,n,i,r={147:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.ActionPoints=void 0;var n=function(){function t(){this.span=document.getElementById("actionPointsSpan"),this.current=1,this.total=1,this.tentative=0}return t.prototype.startTurn=function(){10!==this.total&&this.total++,this.current=this.total,this.render()},t.prototype.tentativeSpend=function(t){this.tentative=t,this.render()},t.prototype.spend=function(){this.current-=this.tentative,this.tentative=0,this.render()},t.prototype.clearSpend=function(){this.tentative=0,this.render()},t.prototype.render=function(){var t="";t+="ðŸŸ©".repeat(this.current-this.tentative),t+="ðŸŸ¨".repeat(this.tentative),t+="ðŸŸ¥".repeat(this.total-this.current),this.span.textContent=t},t}();e.ActionPoints=n},68:function(t,e,n){var i,r=this&&this.__extends||(i=function(t,e){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},i(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0}),e.ComPlayer=void 0;var a=n(147),o=n(589),s=n(924),c=n(627),d=n(579),h=function(t){function e(e,n){var i=t.call(this)||this;return i.availableIngredients=["white bread","bacon"],i.ingredientCounts=Array(i.availableIngredients.length).fill(0),i.actionPoints=new a.ActionPoints,i.boardDiv=e,i.scoresDiv=n,i.sandwiches=[],i}return r(e,t),e.prototype.startDeckSelect=function(){this.deckSelectEndCallback()},e.prototype.startGame=function(){for(var t=0;t<this.ingredientCounts.length;++t)this.ingredientCounts[t]=0;this.constructDOM(),this.startTurn()},e.prototype.constructDOM=function(){this.boardDiv.innerHTML="",this.createEmptyStack()},e.prototype.createEmptyStack=function(){if(!(this.sandwiches.length>=o.MAX_SANDWICH_COUNT)){var t=document.createElement("div"),e=new d.Sandwich(t);this.boardDiv.appendChild(t),e.sandwichStartedCallback=this.createEmptyStack.bind(this),e.animationDoneCallback=this.sandwichAnimationEndCallback,this.sandwiches.push(e)}},e.prototype.startTurn=function(){this.turnEndCallback()},e.prototype.getAnimationActions=function(){return this.actionPoints.startTurn(),this.drawCards(),this.playCards(),t.prototype.getAnimationActions.call(this)},e.prototype.drawCards=function(){for(var t=this.availableIngredients.length,e=0;e<3;++e){var n=Math.floor(Math.random()*t);this.ingredientCounts[n]++}},e.prototype.canPlay=function(t){return s.ingredients.get(this.availableIngredients[t]).cost<=this.actionPoints.current&&this.ingredientCounts[t]>0},e.prototype.playCards=function(){for(var t=this.availableIngredients.length,e=0;e<3;++e){var n=Math.floor(Math.random()*t),i=s.ingredients.get(this.availableIngredients[n]);if(this.canPlay(n)){for(var r=[],a=0;a<this.sandwiches.length;++a)this.sandwiches[a].canAddIngredient(i)&&r.push(a);if(0===r.length)continue;var o=Math.floor(Math.random()*r.length);this.sandwiches[r[o]].addIngredient(i)}}},e}(c.Player);e.ComPlayer=h},589:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.MAX_SANDWICH_COUNT=e.ANIM_TIMEOUT=void 0,e.ANIM_TIMEOUT=1e3,e.MAX_SANDWICH_COUNT=6},784:(t,e,n)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.Game=void 0;var i=n(233),r=function(){function t(t){this.deckSelects=0,this.turnEnds=0,this.animationEnds=0,this.players=t;for(var e=0,n=t;e<n.length;e++){var r=n[e];r.turnEndCallback=this.endTurnForPlayer.bind(this),r.deckSelectEndCallback=this.selectDeckForPlayer.bind(this),r.sandwichAnimationEndCallback=this.playAnimation.bind(this),r.startDeckSelect()}this.turnState=i.TurnState.SELECTING_DECK}return t.prototype.selectDeckForPlayer=function(){if(this.deckSelects++,this.deckSelects===this.players.length){this.deckSelects=0,this.turnState=i.TurnState.TURN_ACTIVE;for(var t=0,e=this.players;t<e.length;t++)e[t].startGame()}},t.prototype.endTurnForPlayer=function(){var t;if(this.turnEnds++,this.turnEnds===this.players.length){this.turnEnds=0,this.turnState=i.TurnState.ANIMS_PLAYING,this.animationCounter=0,this.animations=[];for(var e=0,n=this.players;e<n.length;e++){var r=n[e].getAnimationActions();(t=this.animations).push.apply(t,r)}this.playAnimation()}},t.prototype.playAnimation=function(){if(this.animationCounter>=this.animations.length){this.turnState=i.TurnState.TURN_ACTIVE;for(var t=0,e=this.players;t<e.length;t++)e[t].startTurn()}else this.animations[this.animationCounter++].animate()},t}();e.Game=r},924:(t,e,n)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.ingredients=void 0;var i=n(233),r={name:"white bread",cost:1,power:1,effect:function(t){},type:i.IngredientType.BREAD,effectText:"",flavorText:"the plainest option"},a={name:"bacon",cost:1,power:1,effect:function(t){t.ingredients.map((function(t){return t.power++,t}))},type:i.IngredientType.MEAT,effectText:"on complete, add one to each ingredient in this sandwich",flavorText:"bacon goes on everything"},o=new Map;e.ingredients=o,o.set("bacon",a),o.set("white bread",r)},346:function(t,e,n){var i,r=this&&this.__extends||(i=function(t,e){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},i(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0}),e.LocalPlayer=void 0;var a=n(147),o=n(589),s=n(924),c=n(627),d=n(579),h=function(t){function e(e,n,i){var r=t.call(this)||this;return r.score=0,r.availableIngredients=["white bread","bacon"],r.ingredientCounts=Array(r.availableIngredients.length).fill(0),r.ingredientDOMs=[],r.actionPoints=new a.ActionPoints,r.endTurnButton=document.getElementById("endTurnButton"),r.ingredientDiv=e,r.boardDiv=n,r.scoresDiv=i,r.sandwiches=[],r}return r(e,t),e.prototype.startDeckSelect=function(){this.deckSelectEndCallback()},e.prototype.startGame=function(){for(var t=0;t<this.ingredientCounts.length;++t)this.ingredientCounts[t]=0;this.constructDOM(),this.startTurn()},e.prototype.constructDOM=function(){this.ingredientDiv.innerHTML="";for(var t=0;t<this.availableIngredients.length;++t){var e=document.createElement("div");e.className="tooltip",e.draggable=!0;var n=document.createElement("span");e.appendChild(n);var i=document.createElement("span");i.className="tooltipText";var r=s.ingredients.get(this.availableIngredients[t]);i.innerHTML="".concat(r.name,": ").concat(r.cost,"/").concat(r.power,"<br><br>"),""!==r.effectText&&(i.innerHTML+="".concat(r.effectText,"<br><br>")),i.innerHTML+="<i>".concat(r.flavorText,"</i>"),e.ondragstart=this.dragCard.bind(this,t),e.ondragend=this.stopDrag.bind(this),e.onmouseover=this.hoverCard.bind(this,t),e.onmouseout=this.unhoverCard.bind(this),e.appendChild(i),this.ingredientDiv.appendChild(e),this.ingredientDOMs.push(n)}this.boardDiv.innerHTML="",this.createEmptyStack();var a=document.createElement("div");a.innerText="Score: ",this.scoreSpan=document.createElement("span"),a.appendChild(this.scoreSpan),this.scoreSpan.innerText="0",this.scoresDiv.appendChild(a),this.render(),this.endTurnButton.onclick=this.endTurn.bind(this)},e.prototype.render=function(){for(var t=0;t<this.ingredientDOMs.length;++t){var e=this.availableIngredients[t];this.ingredientDOMs[t].textContent="".concat(e,": ").concat(this.ingredientCounts[t])}this.actionPoints.render()},e.prototype.startTurn=function(){this.endTurnButton.textContent="End turn",this.endTurnButton.disabled=!1,this.actionPoints.startTurn(),this.drawCards(),this.render()},e.prototype.endTurn=function(){this.endTurnButton.textContent="waiting...",this.endTurnButton.disabled=!0,this.turnEndCallback()},e.prototype.drawCards=function(){for(var t=this.availableIngredients.length,e=0;e<3;++e){var n=Math.floor(Math.random()*t);this.ingredientCounts[n]++}this.render()},e.prototype.createEmptyStack=function(){var t=this;if(!(this.sandwiches.length>=o.MAX_SANDWICH_COUNT)){var e=document.createElement("div"),n=new d.Sandwich(e);e.ondrop=this.dropHandler.bind(this,this.sandwiches.length),e.ondragenter=this.canDropCurrentlyHeld.bind(this,this.sandwiches.length),e.ondragover=this.canDropCurrentlyHeld.bind(this,this.sandwiches.length),this.boardDiv.appendChild(e),n.sandwichStartedCallback=this.createEmptyStack.bind(this),n.animationDoneCallback=function(i){n.isClosed&&(t.score+=n.score,t.scoreSpan.innerText=t.score.toString(),t.sandwiches.length===o.MAX_SANDWICH_COUNT&&t.createEmptyStack(),t.sandwiches.splice(i),e.remove()),t.sandwichAnimationEndCallback()}.bind(this,this.sandwiches.length),this.sandwiches.push(n)}},e.prototype.canPlay=function(t){return s.ingredients.get(this.availableIngredients[t]).cost<=this.actionPoints.current&&this.ingredientCounts[t]>0},e.prototype.hoverCard=function(t,e){e.stopPropagation();var n=e.target.parentElement;this.canPlay(t)?n.classList.add("canPlay"):n.classList.add("cantPlay")},e.prototype.unhoverCard=function(t){t.stopPropagation();var e=t.target.parentElement;e.classList.remove("canPlay"),e.classList.remove("cantPlay")},e.prototype.dragCard=function(t,e){if(e.stopPropagation(),this.canPlay(t)){this.currentlyDraggedIngredient=s.ingredients.get(this.availableIngredients[t]);for(var n=0,i=this.sandwiches;n<i.length;n++)i[n].showIfValidTarget(this.currentlyDraggedIngredient);e.dataTransfer.setData("ingId",t.toString()),e.dataTransfer.dropEffect="copy",e.target.classList.add("dragging"),this.actionPoints.tentativeSpend(this.currentlyDraggedIngredient.cost)}else e.preventDefault()},e.prototype.stopDrag=function(t){t.stopPropagation(),t.target.classList.remove("dragging"),this.actionPoints.clearSpend();for(var e=0,n=this.sandwiches;e<n.length;e++)n[e].clearTargetColors()},e.prototype.canDropCurrentlyHeld=function(t,e){this.sandwiches[t].canAddIngredient(this.currentlyDraggedIngredient)&&e.preventDefault()},e.prototype.dropHandler=function(t,e){e.stopPropagation();var n=e.dataTransfer.getData("ingId"),i=s.ingredients.get(this.availableIngredients[n]);this.sandwiches[t].addIngredient(i)&&(e.preventDefault(),this.ingredientCounts[n]--,this.actionPoints.spend(),this.render())},e}(c.Player);e.LocalPlayer=h},627:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.Player=void 0;var n=function(){function t(){}return t.prototype.deckSelectEndCallback=function(){},t.prototype.turnEndCallback=function(){},t.prototype.sandwichAnimationEndCallback=function(){},t.prototype.startDeckSelect=function(){},t.prototype.startGame=function(){},t.prototype.startTurn=function(){},t.prototype.getAnimationActions=function(){for(var t=[],e=0,n=this.sandwiches;e<n.length;e++){var i=n[e];t.push(i),i.prepAnimate()}return t},t}();e.Player=n},579:(t,e,n)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.Sandwich=void 0;var i=n(589),r=n(233),a=n(110),o=function(){function t(t){this.ingredients=[],this.spans=[],this.animateEvents=[];var e=document.createElement("div");e.innerText="Power: ",this.powerSpan=document.createElement("span"),this.powerSpan.innerText="0",e.appendChild(this.powerSpan),t.appendChild(e),this.ingredientDiv=document.createElement("div"),this.ingredientDiv.id="sandwich",t.appendChild(this.ingredientDiv),this.isClosed=!1,this.score=0}return t.prototype.setScore=function(){this.score=0;for(var t=0,e=this.ingredients;t<e.length;t++){var n=e[t];this.score+=n.power}this.powerSpan.innerText=this.score.toString()},t.prototype.close=function(){this.isClosed=!0;for(var t=0,e=this.ingredients;t<e.length;t++)e[t].effect(this)},t.prototype.canAddIngredient=function(t){return(0!==this.ingredients.length||t.type===r.IngredientType.BREAD)&&!this.isClosed},t.prototype.showIfValidTarget=function(t){this.canAddIngredient(t)?this.ingredientDiv.style.background="seagreen":this.ingredientDiv.style.background="tomato"},t.prototype.clearTargetColors=function(){this.ingredientDiv.style.background="lightgrey"},t.prototype.addIngredient=function(t){if(!this.canAddIngredient)return!1;var e=document.createElement("div"),n=document.createElement("span");n.textContent=t.name,e.appendChild(n),e.className="tooltip";var i=document.createElement("span");i.className="tooltipText",i.innerHTML="".concat(t.name,": ").concat(t.cost,"/").concat(t.power,"<br><br>"),""!==t.effectText&&(i.innerHTML+="".concat(t.effectText,"<br><br>")),i.innerHTML+="<i>".concat(t.flavorText,"</i>"),e.appendChild(i),this.ingredients.unshift((0,a.deepCopy)(t)),this.spans.push(n),this.ingredientDiv.insertBefore(e,this.ingredientDiv.firstChild);var o=new r.IngredientAddEvent;return o.name=t.name,o.span=n,this.animateEvents.push(o),t.type===r.IngredientType.CONDIMENT&&t.effect(this),1===this.ingredients.length?this.sandwichStartedCallback():t.type===r.IngredientType.BREAD&&(this.isClosed=!0),this.setScore(),!0},t.prototype.prepAnimate=function(){for(var t=0,e=this.animateEvents;t<e.length;t++){var n=e[t];n instanceof r.IngredientAddEvent&&(n.span.textContent="???")}},t.prototype.animate=function(){if(0===this.animateEvents.length)this.animationDoneCallback();else{if(this.isClosed)for(var t=0;t<this.ingredients.length;++t){var e=new r.IngredientEffectEvent;e.ing=this.ingredients[t],e.span=this.spans[t],this.animateEvents.push(e)}setTimeout(this.animateInterval.bind(this,0),i.ANIM_TIMEOUT)}},t.prototype.animateInterval=function(t){var e=this.animateEvents[t];e instanceof r.IngredientAddEvent?e.span.textContent=e.name:e instanceof r.IngredientEffectEvent&&(e.span.style.fontWeight="bold",e.ing.effect(this),this.setScore()),t>=this.animateEvents.length-1?(this.animateEvents=[],this.animationDoneCallback()):setTimeout(this.animateInterval.bind(this,t+1),i.ANIM_TIMEOUT)},t}();e.Sandwich=o},233:(t,e)=>{var n,i;Object.defineProperty(e,"__esModule",{value:!0}),e.IngredientEffectEvent=e.IngredientAddEvent=e.TurnState=e.IngredientType=void 0,function(t){t[t.BREAD=0]="BREAD",t[t.MEAT=1]="MEAT",t[t.VEGETABLE=2]="VEGETABLE",t[t.CONDIMENT=3]="CONDIMENT"}(n||(e.IngredientType=n={})),function(t){t[t.SELECTING_DECK=0]="SELECTING_DECK",t[t.TURN_ACTIVE=1]="TURN_ACTIVE",t[t.ANIMS_PLAYING=2]="ANIMS_PLAYING",t[t.GAME_END=3]="GAME_END"}(i||(e.TurnState=i={}));e.IngredientAddEvent=function(){};e.IngredientEffectEvent=function(){}},110:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.deepCopy=void 0,e.deepCopy=function t(e){if("object"!=typeof e)return e;var n={};for(var i in e)n[i]=t(e[i]);return n}}},a={};function o(t){var e=a[t];if(void 0!==e)return e.exports;var n=a[t]={exports:{}};return r[t].call(n.exports,n,n.exports,o),n.exports}t=o(68),e=o(784),n=new(o(346).LocalPlayer)(document.getElementById("ingredients"),document.getElementById("myBoard"),document.getElementById("myScores")),i=new t.ComPlayer(document.getElementById("opponentBoard"),document.getElementById("myScores")),new e.Game([n,i])})();